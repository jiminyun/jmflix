{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jiminyun/workspaces/jmflix/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/Users/jiminyun/workspaces/jmflix/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"/Users/jiminyun/workspaces/jmflix/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jiminyun/workspaces/jmflix/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jiminyun/workspaces/jmflix/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jiminyun/workspaces/jmflix/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jiminyun/workspaces/jmflix/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jiminyun/workspaces/jmflix/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/jiminyun/workspaces/jmflix/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/jiminyun/workspaces/jmflix/src/Routes/Home/HomeContainer.js\";\nimport React from \"react\";\nimport HomePresenter from \"./HomePresenter\";\nimport { moviesApi } from \"API\";\n\nvar _default =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(_default, _React$Component);\n\n  function _default(props) {\n    var _this;\n\n    _classCallCheck(this, _default);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(_default).call(this, props)); // Sets up our initial state\n\n    _this.loadnowPlaying =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _ref2, nowPlaying;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return moviesApi.nowPlaying(_this.state.page);\n\n            case 3:\n              _ref2 = _context.sent;\n              nowPlaying = _ref2.data.results;\n\n              if (_this.state.nowPlaying) {\n                _this.setState(function (prevState) {\n                  return {\n                    nowPlaying: _toConsumableArray(prevState.nowPlaying).concat(_toConsumableArray(nowPlaying))\n                  };\n                });\n              } else {\n                _this.setState({\n                  nowPlaying: nowPlaying\n                });\n              }\n\n              _context.next = 10;\n              break;\n\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n\n            case 10:\n              _context.prev = 10;\n\n              _this.setState({\n                loading: false\n              });\n\n              return _context.finish(10);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[0, 8, 10, 13]]);\n    }));\n    _this.state = {\n      nowPlaying: null,\n      upcoming: null,\n      popular: null,\n      error: null,\n      loading: true,\n      hasMore: true,\n      page: 1\n    }; // Binds our scroll event handler\n\n    window.onscroll = function () {\n      var _assertThisInitialize = _assertThisInitialized(_assertThisInitialized(_this)),\n          loadnowPlaying = _assertThisInitialize.loadnowPlaying,\n          _assertThisInitialize2 = _assertThisInitialize.state,\n          error = _assertThisInitialize2.error,\n          loading = _assertThisInitialize2.loading,\n          hasMore = _assertThisInitialize2.hasMore; // Bails early if:\n      // * there's an error\n      // * it's already loading\n      // * there's nothing left to load\n\n\n      if (error || loading || !hasMore) return; // Checks that the page has scrolled to the bottom\n\n      if (window.innerHeight + document.documentElement.scrollTop === document.documentElement.offsetHeight) {\n        _this.setState(function (prevState) {\n          return {\n            page: prevState.page + 1\n          };\n        });\n\n        loadnowPlaying();\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(_default, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      // Loads some users on initial load\n      this.loadnowPlaying();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      console.log(this.state);\n      var _this$state = this.state,\n          nowPlaying = _this$state.nowPlaying,\n          upcoming = _this$state.upcoming,\n          popular = _this$state.popular,\n          error = _this$state.error,\n          loading = _this$state.loading;\n      return React.createElement(HomePresenter, {\n        nowPlaying: nowPlaying,\n        upcoming: upcoming,\n        popular: popular,\n        error: error,\n        loading: loading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return _default;\n}(React.Component);\n\nexport { _default as default };","map":{"version":3,"sources":["/Users/jiminyun/workspaces/jmflix/src/Routes/Home/HomeContainer.js"],"names":["React","HomePresenter","moviesApi","props","loadnowPlaying","nowPlaying","state","page","data","results","setState","prevState","loading","upcoming","popular","error","hasMore","window","onscroll","innerHeight","document","documentElement","scrollTop","offsetHeight","console","log","Component"],"mappings":";;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,aAAP,MAA0B,iBAA1B;AACA,SAASC,SAAT,QAA0B,KAA1B;;;;;;;AAGE,oBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,kFAAMA,KAAN,GADiB,CAGjB;;AAHiB,UA8CnBC,cA9CmB;AAAA;AAAA;AAAA;AAAA,6BA8CF;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAIHF,SAAS,CAACG,UAAV,CAAqB,MAAKC,KAAL,CAAWC,IAAhC,CAJG;;AAAA;AAAA;AAGMF,cAAAA,UAHN,SAGXG,IAHW,CAGHC,OAHG;;AAMb,kBAAI,MAAKH,KAAL,CAAWD,UAAf,EAA2B;AACzB,sBAAKK,QAAL,CAAc,UAAAC,SAAS;AAAA,yBAAK;AAC1BN,oBAAAA,UAAU,qBAAMM,SAAS,CAACN,UAAhB,4BAA+BA,UAA/B;AADgB,mBAAL;AAAA,iBAAvB;AAGD,eAJD,MAIO;AACL,sBAAKK,QAAL,CAAc;AACZL,kBAAAA,UAAU,EAAVA;AADY,iBAAd;AAGD;;AAdY;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAiBb,oBAAKK,QAAL,CAAc;AACZE,gBAAAA,OAAO,EAAE;AADG,eAAd;;AAjBa;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA9CE;AAIjB,UAAKN,KAAL,GAAa;AACXD,MAAAA,UAAU,EAAE,IADD;AAEXQ,MAAAA,QAAQ,EAAE,IAFC;AAGXC,MAAAA,OAAO,EAAE,IAHE;AAIXC,MAAAA,KAAK,EAAE,IAJI;AAKXH,MAAAA,OAAO,EAAE,IALE;AAMXI,MAAAA,OAAO,EAAE,IANE;AAOXT,MAAAA,IAAI,EAAE;AAPK,KAAb,CAJiB,CAcjB;;AACAU,IAAAA,MAAM,CAACC,QAAP,GAAkB,YAAM;AAAA;AAAA,UAEpBd,cAFoB,yBAEpBA,cAFoB;AAAA,yDAGpBE,KAHoB;AAAA,UAGXS,KAHW,0BAGXA,KAHW;AAAA,UAGJH,OAHI,0BAGJA,OAHI;AAAA,UAGKI,OAHL,0BAGKA,OAHL,EAMtB;AACA;AACA;AACA;;;AACA,UAAID,KAAK,IAAIH,OAAT,IAAoB,CAACI,OAAzB,EAAkC,OAVZ,CAYtB;;AACA,UACEC,MAAM,CAACE,WAAP,GAAqBC,QAAQ,CAACC,eAAT,CAAyBC,SAA9C,KACAF,QAAQ,CAACC,eAAT,CAAyBE,YAF3B,EAGE;AACA,cAAKb,QAAL,CAAc,UAAAC,SAAS;AAAA,iBAAK;AAC1BJ,YAAAA,IAAI,EAAEI,SAAS,CAACJ,IAAV,GAAiB;AADG,WAAL;AAAA,SAAvB;;AAIAH,QAAAA,cAAc;AACf;AACF,KAvBD;;AAfiB;AAuClB;;;;yCAEoB;AACnB;AACA,WAAKA,cAAL;AACD;;;6BAyBQ;AACPoB,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKnB,KAAjB;AADO,wBAEmD,KAAKA,KAFxD;AAAA,UAECD,UAFD,eAECA,UAFD;AAAA,UAEaQ,QAFb,eAEaA,QAFb;AAAA,UAEuBC,OAFvB,eAEuBA,OAFvB;AAAA,UAEgCC,KAFhC,eAEgCA,KAFhC;AAAA,UAEuCH,OAFvC,eAEuCA,OAFvC;AAGP,aACE,oBAAC,aAAD;AACE,QAAA,UAAU,EAAEP,UADd;AAEE,QAAA,QAAQ,EAAEQ,QAFZ;AAGE,QAAA,OAAO,EAAEC,OAHX;AAIE,QAAA,KAAK,EAAEC,KAJT;AAKE,QAAA,OAAO,EAAEH,OALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AASD;;;;EAlF0BZ,KAAK,CAAC0B,S","sourcesContent":["import React from \"react\";\nimport HomePresenter from \"./HomePresenter\";\nimport { moviesApi } from \"API\";\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props);\n\n    // Sets up our initial state\n    this.state = {\n      nowPlaying: null,\n      upcoming: null,\n      popular: null,\n      error: null,\n      loading: true,\n      hasMore: true,\n      page: 1\n    };\n\n    // Binds our scroll event handler\n    window.onscroll = () => {\n      const {\n        loadnowPlaying,\n        state: { error, loading, hasMore }\n      } = this;\n\n      // Bails early if:\n      // * there's an error\n      // * it's already loading\n      // * there's nothing left to load\n      if (error || loading || !hasMore) return;\n\n      // Checks that the page has scrolled to the bottom\n      if (\n        window.innerHeight + document.documentElement.scrollTop ===\n        document.documentElement.offsetHeight\n      ) {\n        this.setState(prevState => ({\n          page: prevState.page + 1\n        }));\n\n        loadnowPlaying();\n      }\n    };\n  }\n\n  componentWillMount() {\n    // Loads some users on initial load\n    this.loadnowPlaying();\n  }\n\n  loadnowPlaying = async () => {\n    try {\n      const {\n        data: { results: nowPlaying }\n      } = await moviesApi.nowPlaying(this.state.page);\n\n      if (this.state.nowPlaying) {\n        this.setState(prevState => ({\n          nowPlaying: [...prevState.nowPlaying, ...nowPlaying]\n        }));\n      } else {\n        this.setState({\n          nowPlaying\n        });\n      }\n    } catch {\n    } finally {\n      this.setState({\n        loading: false\n      });\n    }\n  };\n\n  render() {\n    console.log(this.state);\n    const { nowPlaying, upcoming, popular, error, loading } = this.state;\n    return (\n      <HomePresenter\n        nowPlaying={nowPlaying}\n        upcoming={upcoming}\n        popular={popular}\n        error={error}\n        loading={loading}\n      />\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}